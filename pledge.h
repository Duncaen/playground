#include <stdint.h>

#define PLEDGED         0x1000000000000000ULL
#define PLEDGE_ALWAYS   0xffffffffffffffffULL
#define PLEDGE_DEBUG    0x0000000000000001ULL
#define PLEDGE_VERBOSE  0x0000000000000002ULL
#define PLEDGE_IOCTL    0x0000000000000010ULL
#define PLEDGE_RPATH    0x0000000000000020ULL
#define PLEDGE_WPATH    0x0000000000000040ULL
#define PLEDGE_CPATH    0x0000000000000080ULL
#define PLEDGE_STDIO    0x0000000000000100ULL
#define PLEDGE_CHOWN    0x0000000000000200ULL
#define PLEDGE_DPATH    0x0000000000000400ULL
#define PLEDGE_DRM      0x0000000000000800ULL
#define PLEDGE_EXEC     0x0000000000001000ULL
#define PLEDGE_FATTR    0x0000000000002000ULL
#define PLEDGE_FLOCK    0x0000000000004000ULL
#define PLEDGE_GETPW    0x0000000000008000ULL
#define PLEDGE_INET     0x0000000000010000ULL
#define PLEDGE_PROC     0x0000000000020000ULL
#define PLEDGE_ID       0x0000000000040000ULL
#define PLEDGE_SETTIME  0x0000000000080000ULL
#define PLEDGE_UNIX     0x0000000000100000ULL
#define PLEDGE_CHOWNUID 0x0000000000200000ULL
#define PLEDGE_EMUL     0x0000000000400000ULL
#define PLEDGE_IPC      0x0000000000800000ULL
#define PLEDGE_MOUNT    0x0000000001000000ULL
#define PLEDGE_KEY      0x0000000002000000ULL
#define PLEDGE_KERN     0x0000000004000000ULL

struct sock_fprog *pledge_whitelist(uint64_t);
struct sock_fprog *pledge_blacklist(uint64_t, uint64_t);
struct sock_fprog *pledge_filter(uint64_t, uint64_t);
uint64_t pledge_flags(const char *);
int pledge(const char *, const char *[]);
